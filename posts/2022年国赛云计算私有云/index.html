<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>2022年国赛云计算私有云 - Feyncode的博客 - 每天进步一点点</title><meta name="author" content="feyncode">
<meta name="author-link" content="">
<meta name="description" content="" /><meta name="keywords" content='draft' /><meta itemprop="name" content="2022年国赛云计算私有云">
<meta itemprop="description" content=""><meta itemprop="datePublished" content="2023-02-02T13:40:04+08:00" />
<meta itemprop="dateModified" content="2023-02-02T13:40:04+08:00" />
<meta itemprop="wordCount" content="8723">
<meta itemprop="keywords" content="draft," /><meta property="og:title" content="2022年国赛云计算私有云" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://feyncode.github.io/posts/2022%E5%B9%B4%E5%9B%BD%E8%B5%9B%E4%BA%91%E8%AE%A1%E7%AE%97%E7%A7%81%E6%9C%89%E4%BA%91/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-02T13:40:04+08:00" />
<meta property="article:modified_time" content="2023-02-02T13:40:04+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="2022年国赛云计算私有云"/>
<meta name="twitter:description" content=""/>
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="http://feyncode.github.io/posts/2022%E5%B9%B4%E5%9B%BD%E8%B5%9B%E4%BA%91%E8%AE%A1%E7%AE%97%E7%A7%81%E6%9C%89%E4%BA%91/" /><link rel="prev" href="http://feyncode.github.io/posts/python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "2022年国赛云计算私有云",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/feyncode.github.io\/posts\/2022%E5%B9%B4%E5%9B%BD%E8%B5%9B%E4%BA%91%E8%AE%A1%E7%AE%97%E7%A7%81%E6%9C%89%E4%BA%91\/"
    },"genre": "posts","keywords": "draft","wordcount":  8723 ,
    "url": "http:\/\/feyncode.github.io\/posts\/2022%E5%B9%B4%E5%9B%BD%E8%B5%9B%E4%BA%91%E8%AE%A1%E7%AE%97%E7%A7%81%E6%9C%89%E4%BA%91\/","datePublished": "2023-02-02T13:40:04+08:00","dateModified": "2023-02-02T13:40:04+08:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "feyncode"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Feyncode的博客 - 每天进步一点点"><img
    class="lazyload logo"
    src="/svg/loading.min.svg"
    data-src="/fixit.min.svg"
    data-srcset="/fixit.min.svg, /fixit.min.svg 1.5x, /fixit.min.svg 2x"
    data-sizes="auto"
    alt="Feyncode的博客 - 每天进步一点点"
    title="Feyncode的博客 - 每天进步一点点"/><span class="header-title-text">费冰の空间</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 文章</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容 ..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li>
      </ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Feyncode的博客 - 每天进步一点点"><img
    class="lazyload logo"
    src="/svg/loading.min.svg"
    data-src="/fixit.min.svg"
    data-srcset="/fixit.min.svg, /fixit.min.svg 1.5x, /fixit.min.svg 2x"
    data-sizes="auto"
    alt="/fixit.min.svg"
    title="/fixit.min.svg"/><span class="header-title-text">费冰の空间</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容 ..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 文章</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container" data-page-style="normal"><aside class="toc" id="toc-auto"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside>

  <aside class="aside-custom">
    
</aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX">
        <span>2022年国赛云计算私有云</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="https://github.com/feyncode" title="作者"target="_blank" rel="external nofollow noopener noreferrer author" class="author"><img
    class="lazyload avatar"
    src="/svg/loading.min.svg"
    data-src="/fixit.min.svg"
    data-srcset="/fixit.min.svg, /fixit.min.svg 1.5x, /fixit.min.svg 2x"
    data-sizes="auto"
    alt="feyncode"
    title="feyncode"/>&nbsp;feyncode</a></span>
          <span class="post-category">收录于 <a href="/categories/draft/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> draft</a></span></div>
      <div class="post-meta-line"><span title=2023-02-02&#32;13:40:04><i class="fa-regular fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2023-02-02">2023-02-02</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i> 约 8723 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw" aria-hidden="true"></i> 预计阅读 18 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#任务-1--私有云服务搭建-10分">【任务 1 】 私有云服务搭建 （10分）</a>
      <ul>
        <li><a href="#题目-1--基础环境搭建-05-分">【题目 1 】 基础环境搭建 （0.5 分）</a></li>
        <li><a href="#题目-2--yum源配置05-分">【题目 2 】 Yum源配置[0.5 分]</a></li>
        <li><a href="#题目-3--配置无秘钥-ssh05-分">【题目 3 】 配置无秘钥 SSH[0.5 分]</a></li>
        <li><a href="#题目-4--基础安装05-分">【题目 4 】 基础安装[0.5 分]</a></li>
        <li><a href="#题目-5--数据库安装与调优05-分">【题目 5 】 数据库安装与调优[0.5 分]</a></li>
        <li><a href="#题目-6-keystone-服务安装与使用05-分">【题目 6 】Keystone 服务安装与使用[0.5 分]</a></li>
        <li><a href="#题目-7--glance-安装与使用05-分">【题目 7 】 Glance 安装与使用[0.5 分]</a></li>
        <li><a href="#题目-8--nova-安装与优化05-分">【题目 8 】 Nova 安装与优化[0.5 分]</a></li>
        <li><a href="#题目-9--neutron-安装05-分">【题目 9 】 Neutron 安装[0.5 分]</a></li>
        <li><a href="#题目-10--dashboard-安装05-分">【题目 10 】 Dashboard 安装[0.5 分]</a></li>
        <li><a href="#题目-11--swift-安装05-分">【题目 11 】 Swift 安装[0.5 分]</a></li>
        <li><a href="#题目-12--cinder-创建硬盘05-分">【题目 12 】 Cinder 创建硬盘[0.5 分]</a></li>
        <li><a href="#题目-13--manila服务安装与使用05-分">【题目 13 】 Manila服务安装与使用[0.5 分]</a></li>
        <li><a href="#题目-14--barbican-服务安装与使用05-分">【题目 14 】 Barbican 服务安装与使用[0.5 分]</a></li>
        <li><a href="#题目-15--cloudkitty-服务安装与使用1-分">【题目 15 】 Cloudkitty 服务安装与使用[1 分]</a></li>
        <li><a href="#题目-16--openstack平台内存优化05-分">【题目 16 】 Openstack平台内存优化[0.5 分]</a></li>
        <li><a href="#题目-17--修改文件句柄数05-分">【题目 17 】 修改文件句柄数[0.5 分]</a></li>
        <li><a href="#题目-18-linux-系统调优-防止-syn-攻击1-分">【题目 18 】Linux 系统调优-防止 SYN 攻击[1 分]</a></li>
      </ul>
    </li>
    <li><a href="#任务-2私有云服务运维10-分">【任务 2】私有云服务运维[10 分]</a>
      <ul>
        <li><a href="#题目-1openstack-开放镜像权限05-分">【题目 1】OpenStack 开放镜像权限[0.5 分]</a></li>
        <li><a href="#题目-2openstack-消息队列调优05-分">【题目 2】OpenStack 消息队列调优[0.5 分]</a></li>
        <li><a href="#题目-3openstack-glance-镜像压缩05-分">【题目 3】OpenStack Glance 镜像压缩[0.5 分]</a></li>
        <li><a href="#题目-4glance-对接-cinder-后端存储05-分">【题目 4】glance 对接 cinder 后端存储[0.5 分]</a></li>
        <li><a href="#题目-5openstack-heat-运维创建容器05-分">【题目 5】OpenStack Heat 运维：创建容器[0.5 分]</a></li>
        <li><a href="#题目-6openstack-nova-清除缓存05-分">【题目 6】OpenStack Nova 清除缓存[0.5 分]</a></li>
        <li><a href="#题目-7redis-一主二从三哨兵模式1-分">【题目 7】Redis 一主二从三哨兵模式[1 分]</a></li>
        <li><a href="#题目-8redis-服务调优-aof1-分">【题目 8】Redis 服务调优-AOF[1 分]</a></li>
        <li><a href="#题目-9应用部署堡垒机部署05-分">【题目 9】应用部署：堡垒机部署[0.5 分]</a></li>
        <li><a href="#题目-10skywalking-服务部署与应用1-分">【题目 10】skywalking 服务部署与应用[1 分]</a></li>
        <li><a href="#题目-11linux-内核优化1-分">【题目 11】Linux 内核优化[1 分]</a></li>
        <li><a href="#题目-12排错glance-服务排错1-分">【题目 12】排错：Glance 服务排错[1 分]</a></li>
        <li><a href="#题目-13排错数据库排错15-分">【题目 13】排错：数据库排错[1.5 分]</a></li>
      </ul>
    </li>
    <li><a href="#任务-3私有云运维开发10-分">【任务 3】私有云运维开发[10 分]</a>
      <ul>
        <li><a href="#题目-1ansible-服务部署部署-mariadb-集群2-分">【题目 1】Ansible 服务部署：部署 MariaDB 集群[2 分]</a></li>
        <li><a href="#题目-2ansible-服务部署部署-elk-集群服务2-分">【题目 2】Ansible 服务部署：部署 ELK 集群服务[2 分]</a></li>
        <li><a href="#题目-3python-运维开发基于-openstack-restful-api-实现镜像上传1-分">【题目 3】Python 运维开发：基于 OpenStack Restful API 实现镜像上传[1 分]</a></li>
        <li><a href="#题目-4python-运维开发基于-openstack-python-sdk-实现云主机创建1-分">【题目 4】Python 运维开发：基于 Openstack Python SDK 实现云主机创建[1 分]</a></li>
        <li><a href="#题目-5python-运维开发云主机类型管理的命令行工具开发2-分">【题目 5】Python 运维开发：云主机类型管理的命令行工具开发[2 分]</a></li>
        <li><a href="#题目-6python-运维开发用户管理的命令行工具开发2-分">【题目 6】Python 运维开发：用户管理的命令行工具开发[2 分]</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div
      class="content"
      id="content"
      
      
    ><h1 id="2022-年国赛-云计算赛项-私有云">2022 年国赛-云计算赛项-私有云</h1>
<p>【赛程名称】 云计算赛项第一场-私有云</p>
<p>​	某企业拟使用 OpenStack 搭建一个企业云平台，以实现资源池化弹性管理、企业应用集中管理、统一安全认证和授权等管理。系统架构如图 1 所示，本地环境IP地址规划如表 1 所示。</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/feyncode/images/raw/master/gitee/image-20221004171314020.png"
    data-srcset="https://gitee.com/feyncode/images/raw/master/gitee/image-20221004171314020.png, https://gitee.com/feyncode/images/raw/master/gitee/image-20221004171314020.png 1.5x, https://gitee.com/feyncode/images/raw/master/gitee/image-20221004171314020.png 2x"
    data-sizes="auto"
    alt="image-20221004171314020"
    title="image-20221004171314020"/></p>
<p>​																								图 1 系统架构图</p>
<p>​																								表 1 IP地址规划<img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/feyncode/images/raw/master/gitee/image-20221004171443861.png"
    data-srcset="https://gitee.com/feyncode/images/raw/master/gitee/image-20221004171443861.png, https://gitee.com/feyncode/images/raw/master/gitee/image-20221004171443861.png 1.5x, https://gitee.com/feyncode/images/raw/master/gitee/image-20221004171443861.png 2x"
    data-sizes="auto"
    alt="image-20221004171443861"
    title="image-20221004171443861"/></p>
<p>竞赛时会提供三个平台：私有云平台，竞赛系统以及文件服务器</p>
<p>​			竞赛系统用于查题，答题</p>
<p>​			私有云平台用于实例的搭建(如搭建Openstack需要的双节点)</p>
<p>​			文件服务器提供竞赛所需要的所有软件包以及yum仓库等</p>
<p>​	如下为我的本地环境。</p>
<table>
<thead>
<tr>
<th>IP地址</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>192.168.100.10</td>
<td>控制节点(controller)</td>
</tr>
<tr>
<td>192.168.100.20</td>
<td>计算节点(compute)</td>
</tr>
</tbody>
</table>
<blockquote>
<p>约定，将IP地址为192.168.100.10的节点记为 <code>NODE controller</code> ，将IP地址为192.168.100.20的节点记为 <code>NODE compute</code></p>
</blockquote>
<h2 id="任务-1--私有云服务搭建-10分">【任务 1 】 私有云服务搭建 （10分）</h2>
<h3 id="题目-1--基础环境搭建-05-分">【题目 1 】 基础环境搭建 （0.5 分）</h3>
<p>​		使用提供的用户名密码，登录提供的 OpenStack 私有云平台，在当前租户下，使用 CentOS7.9 镜像，创建两台云主机，云主机类型使用 4vCPU/12G/100G_50G 类型。当前租户 下默认存在一张网卡，自行创建第二张网卡并连接至 controller 和 compute 节点（第二张网 卡的网段为 10.10.X.0/24，X 为工位号，不需要创建路由）。自行检查安全组策略，以确保 网络正常通信与 ssh 连接，然后按以下要求配置服务器：</p>
<p>（1）设置控制节点主机名为 controller，设置计算节点主机名为 compute；</p>
<p>（2）修改 hosts 文件将 IP 地址映射为主机名；</p>
<p>​		完成后提交控制节点的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">hostnamectl set-hostname controller
</span></span><span class="line"><span class="cl"><span class="c1"># NODE compute</span>
</span></span><span class="line"><span class="cl">hostnamectl set-hostname compute
</span></span><span class="line"><span class="cl"><span class="c1"># ALL NODE</span>
</span></span><span class="line"><span class="cl">cat &gt;&gt; /etc/hosts <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">192.168.100.10 controller
</span></span></span><span class="line"><span class="cl"><span class="s">192.168.100.20 compute
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;重新远程连接服务器使主机名更改生效&gt;
</span></span></code></pre></div><h3 id="题目-2--yum源配置05-分">【题目 2 】 Yum源配置[0.5 分]</h3>
<p>​		使用提供的 http 服务地址，在 http 服务下，存在 centos7.9 和 iaas 的网络 yum 源，使用 该 http 源作为安装 iaas 平台的网络源。分别设置 controller 节点和 compute 节点的 yum 源文件 http.repo。</p>
<p>​		完成后提交控制节点的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># ALL NODE</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 删除默认yum源</span>
</span></span><span class="line"><span class="cl">rm -rf /etc/yum.repos.d/* 
</span></span><span class="line"><span class="cl"><span class="o">[</span>mv /etc/yum.repos.d/* /media/<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 构建网络源</span>
</span></span><span class="line"><span class="cl">cat &gt; /etc/yum.repos.d/http.repo <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">[centos]
</span></span></span><span class="line"><span class="cl"><span class="s">name=centos
</span></span></span><span class="line"><span class="cl"><span class="s">gpgcheck=0
</span></span></span><span class="line"><span class="cl"><span class="s">baseurl=http://192.168.200.10/centos
</span></span></span><span class="line"><span class="cl"><span class="s">[iaas]
</span></span></span><span class="line"><span class="cl"><span class="s">name=iaas
</span></span></span><span class="line"><span class="cl"><span class="s">gpgcheck=0
</span></span></span><span class="line"><span class="cl"><span class="s">baseurl=http://192.168.200.10/iaas/iaas-repo
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#可以验证源的配置是否正确</span>
</span></span><span class="line"><span class="cl">yum repolist
</span></span></code></pre></div><h3 id="题目-3--配置无秘钥-ssh05-分">【题目 3 】 配置无秘钥 SSH[0.5 分]</h3>
<p>​		配置 controller 节点可以无秘钥访问 compute 节点，配置完成后，尝试 ssh 连接 compute 节点的 hostname 进行测试。</p>
<p>​		完成后提交 controller 节点的用户名、密码和 IP 地址到答题框。</p>
<p>​		这个题目有一个地方需要注意一下，题目说的是配置controller节点可以无秘钥访问compute节点，意思是在controller节点作ssh私钥，然后发公钥给compute节点，这样controller节点可以无秘钥ssh登录compute节点。但是他这个检测，查看控制节点允许计算节点无秘钥登录，所以实际上是检测的是compute节点能不能无秘钥ssh登录controller节点。</p>
<p>​		所以为了在不知道具体判分规则的情况下，建议大家在两个节点上都做一下。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">ssh-keygen 
</span></span><span class="line"><span class="cl">ssh-copy-id compute <span class="c1">#输入yes，输入密码</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># NODE compute</span>
</span></span><span class="line"><span class="cl">ssh-keygen 
</span></span><span class="line"><span class="cl">ssh-copy-id controller <span class="c1">#输入yes，输入密码</span>
</span></span></code></pre></div><h3 id="题目-4--基础安装05-分">【题目 4 】 基础安装[0.5 分]</h3>
<p>​		在控制节点和计算节点上分别安装 openstack-iaas 软件包，根据表 2 配置两个节点脚本 文件中的基本变量（配置脚本文件为/etc/openstack/openrc.sh）。</p>
<p>​																				表 2 云平台配置信息</p>
<p><img
    class="lazyload"
    src="/svg/loading.min.svg"
    data-src="https://gitee.com/feyncode/images/raw/master/gitee/image-20221004141817588.png"
    data-srcset="https://gitee.com/feyncode/images/raw/master/gitee/image-20221004141817588.png, https://gitee.com/feyncode/images/raw/master/gitee/image-20221004141817588.png 1.5x, https://gitee.com/feyncode/images/raw/master/gitee/image-20221004141817588.png 2x"
    data-sizes="auto"
    alt="image-20221004141817588"
    title="image-20221004141817588"/></p>
<p>​				完成后提交控制节点的用户名、密码和 IP 地址到答题框。</p>
<p>​		这个地方是一个花时间比较多的点，然后其实填的内容基本都知道了，那么怎么快速搞定这个文档然后进入到接下来的安装呢。</p>
<p>​		我参照了几位的做法，感觉可能以下这个做法可以在保证准确度的同时兼顾时间的损耗。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">#ALL node</span>
</span></span><span class="line"><span class="cl">yum install openstack-iaas -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#NODE controller</span>
</span></span><span class="line"><span class="cl">vi /etc/openstack/openrc.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:g@^<span class="nv">$@</span>d
</span></span><span class="line"><span class="cl">:g@##@d
</span></span><span class="line"><span class="cl">:%s@#@@
</span></span><span class="line"><span class="cl">:%s@SS<span class="o">=</span>@SS<span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#根据具体情况配置文件</span>
</span></span><span class="line"><span class="cl"><span class="nv">HOST_IP</span><span class="o">=</span>192.168.100.10
</span></span><span class="line"><span class="cl"><span class="nv">HOST_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">HOST_NAME</span><span class="o">=</span>controller
</span></span><span class="line"><span class="cl"><span class="nv">HOST_IP_NODE</span><span class="o">=</span>192.168.100.20
</span></span><span class="line"><span class="cl"><span class="nv">HOST_PASS_NODE</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">HOST_NAME_NODE</span><span class="o">=</span>compute
</span></span><span class="line"><span class="cl"><span class="nv">network_segment_IP</span><span class="o">=</span>192.168.100.0/24
</span></span><span class="line"><span class="cl"><span class="nv">RABBIT_USER</span><span class="o">=</span>openstack
</span></span><span class="line"><span class="cl"><span class="nv">RABBIT_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">DB_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">DOMAIN_NAME</span><span class="o">=</span>demo
</span></span><span class="line"><span class="cl"><span class="nv">ADMIN_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">DEMO_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">KEYSTONE_DBPASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">GLANCE_DBPASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">GLANCE_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">PLACEMENT_DBPASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">PLACEMENT_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">NOVA_DBPASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">NOVA_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">NEUTRON_DBPASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">NEUTRON_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">METADATA_SECRET</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">INTERFACE_NAME</span><span class="o">=</span>eth1
</span></span><span class="line"><span class="cl"><span class="nv">Physical_NAME</span><span class="o">=</span>provider
</span></span><span class="line"><span class="cl"><span class="nv">minvlan</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">maxvlan</span><span class="o">=</span><span class="m">2000</span>
</span></span><span class="line"><span class="cl"><span class="nv">CINDER_DBPASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">CINDER_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">BLOCK_DISK</span><span class="o">=</span>sdb1
</span></span><span class="line"><span class="cl"><span class="nv">SWIFT_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">OBJECT_DISK</span><span class="o">=</span>sdb2
</span></span><span class="line"><span class="cl"><span class="nv">STORAGE_LOCAL_NET_IP</span><span class="o">=</span>192.168.100.20
</span></span><span class="line"><span class="cl"><span class="nv">TROVE_DBPASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">TROVE_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">HEAT_DBPASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">HEAT_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">CEILOMETER_DBPASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">CEILOMETER_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">AODH_DBPASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">AODH_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">ZUN_DBPASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">ZUN_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">KURYR_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">OCTAVIA_DBPASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">OCTAVIA_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">MANILA_DBPASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">MANILA_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">SHARE_DISK</span><span class="o">=</span>sdb3
</span></span><span class="line"><span class="cl"><span class="nv">CLOUDKITTY_DBPASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">CLOUDKITTY_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">BARBICAN_DBPASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl"><span class="nv">BARBICAN_PASS</span><span class="o">=</span><span class="m">000000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">scp /etc/openstack/openrc.sh compute:/etc/openstack/openrc.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># NODE compute</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">parted /dev/sdb
</span></span><span class="line"><span class="cl">mklabel gpt
</span></span><span class="line"><span class="cl">mkpart a 0% 40%
</span></span><span class="line"><span class="cl">mkpart b 40% 50%
</span></span><span class="line"><span class="cl">mkpart c 50% 60%
</span></span><span class="line"><span class="cl">mkpart d 60% 70%
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">lsblk
</span></span><span class="line"><span class="cl">NAME            MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
</span></span><span class="line"><span class="cl">sda               8:0    <span class="m">0</span>   200G  <span class="m">0</span> disk 
</span></span><span class="line"><span class="cl">├─sda1            8:1    <span class="m">0</span>     1G  <span class="m">0</span> part /boot
</span></span><span class="line"><span class="cl">└─sda2            8:2    <span class="m">0</span>   199G  <span class="m">0</span> part 
</span></span><span class="line"><span class="cl">  ├─centos-root 253:0    <span class="m">0</span> 191.1G  <span class="m">0</span> lvm  /
</span></span><span class="line"><span class="cl">  └─centos-swap 253:1    <span class="m">0</span>   7.9G  <span class="m">0</span> lvm  <span class="o">[</span>SWAP<span class="o">]</span>
</span></span><span class="line"><span class="cl">sdb               8:16   <span class="m">0</span>   100G  <span class="m">0</span> disk 
</span></span><span class="line"><span class="cl">├─sdb1            8:17   <span class="m">0</span>    40G  <span class="m">0</span> part 
</span></span><span class="line"><span class="cl">├─sdb2            8:18   <span class="m">0</span>    10G  <span class="m">0</span> part 
</span></span><span class="line"><span class="cl">├─sdb3            8:19   <span class="m">0</span>    10G  <span class="m">0</span> part 
</span></span><span class="line"><span class="cl">└─sdb4            8:20   <span class="m">0</span>    10G  <span class="m">0</span> part 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ALL node</span>
</span></span><span class="line"><span class="cl">iaas-pre-host.sh
</span></span></code></pre></div><h3 id="题目-5--数据库安装与调优05-分">【题目 5 】 数据库安装与调优[0.5 分]</h3>
<p>​		在 controller 节点上使用 iaas-install-mysql.sh 脚本安装 Mariadb、Memcached、RabbitMQ 等服务。安装服务完毕后，修改/etc/my.cnf 文件，完成下列要求：</p>
<p>​		1.设置数据库支持大小写；</p>
<p>​		2.设置数据库缓存 innodb 表的索引，数据，插入数据时的缓冲为 4G；</p>
<p>​		3.设置数据库的 log buffer 为 64MB；</p>
<p>​		4.设置数据库的 redo log 大小为 256MB；</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">iaas-install-mysql.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat &gt;&gt;/etc/my.cnf<span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">lower_case_table_names = 1
</span></span></span><span class="line"><span class="cl"><span class="s">innodb_buffer_pool_size = 4G
</span></span></span><span class="line"><span class="cl"><span class="s">innodb_log_buffer_size = 64MB
</span></span></span><span class="line"><span class="cl"><span class="s">innodb_log_file_size = 256MB
</span></span></span><span class="line"><span class="cl"><span class="s">innodb_log_files_in_group = 2
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">systemctl restart mariadb
</span></span></code></pre></div><h3 id="题目-6-keystone-服务安装与使用05-分">【题目 6 】Keystone 服务安装与使用[0.5 分]</h3>
<p>​		在 controller 节点上使用 iaas-install-keystone.sh 脚本安装 Keystone 服务。安装完成后， 使用相关命令，创建用户 chinaskill，密码为 000000。完成后提交控制节点的用户名、密码 和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">iaas-install-keystone.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">openstack user create chinaskill --password <span class="m">000000</span> 
</span></span></code></pre></div><h3 id="题目-7--glance-安装与使用05-分">【题目 7 】 Glance 安装与使用[0.5 分]</h3>
<p>​		在 controller 节点上使用 iaas-install-glance.sh 脚本安装 glance 服务。使用命令将提供 的 cirros-0.3.4-x86_64-disk.img 镜像（该镜像在 HTTP 服务中，可自行下载）上传至平台， 命名为 cirros，并设置最小启动需要的硬盘为 10G，最小启动需要的内存为 1G。完成后提交 控制节点的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">iaas-install-glance.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">openstack image create cirros --file cirros-0.3.4-x86_64-disk.img --disk-format qcow2 --container-format bare --public --min-disk <span class="m">10</span> --min-ram <span class="m">1024</span>
</span></span></code></pre></div><h3 id="题目-8--nova-安装与优化05-分">【题目 8 】 Nova 安装与优化[0.5 分]</h3>
<p>​		在 controller 节点和 compute 节点上分别使用 iaas-install-placement.sh 脚本、 iaas-install-nova -controller.sh 脚本、iaas-install-nova-compute.sh 脚本安装 Nova 服务。安装完 成后，请修改 nova 相关配置文件，解决因等待时间过长而导致虚拟机启动超时从而获取不 到 IP 地址而报错失败的问题。配置完成后提交 controller 点的用户名、密码和 IP 地址到答 题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">iaas-install-placement.sh
</span></span><span class="line"><span class="cl">iaas-install-nova-controller.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># NODE compute</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">iaas-install-nova-compute.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">sed -i <span class="s1">&#39;95avif_plugging_is_fatal=false&#39;</span> /etc/nova/nova.conf
</span></span><span class="line"><span class="cl">systemctl restart openstack-nova*
</span></span></code></pre></div><h3 id="题目-9--neutron-安装05-分">【题目 9 】 Neutron 安装[0.5 分]</h3>
<p>​		使用提供的脚本 iaas-install-neutron-controller.sh 和 iaas-install-neutron-compute.sh，在 controller 和 compute 节点上安装 neutron 服务。完成后提交控制节点的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">iaas-install-neutron-controller.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># NODE compute</span>
</span></span><span class="line"><span class="cl">iaas-install-neutron-compute.sh
</span></span></code></pre></div><h3 id="题目-10--dashboard-安装05-分">【题目 10 】 Dashboard 安装[0.5 分]</h3>
<p>​		在controller节点上使用iaas-install-dashboad.sh脚本安装dashboad服务。安装完成后， 将 Dashboard 中的 Djingo 数据修改为存储在文件中（此种修改解决了 ALL-in-one 快照在其 他云平台 Dashboard 不能访问的问题）。完成后提交控制节点的用户名、密码和 IP 地址到 答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">iaas-install-dashboard.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sed -i <span class="s1">&#39;s/backends.cache/backends.file/&#39;</span> /etc/openstack-dashboard/local_settings 
</span></span><span class="line"><span class="cl">systemctl restart httpd memcached
</span></span></code></pre></div><h3 id="题目-11--swift-安装05-分">【题目 11 】 Swift 安装[0.5 分]</h3>
<p>​		在 控 制 节 点 和 计 算 节 点 上 分 别 使 用 iaas-install-swift-controller.sh 和 iaas-install-swift-compute.sh 脚本安装 Swift 服务。安装完成后，使用命令创建一个名叫 examcontainer 的容器，将 cirros-0.3.4-x86_64-disk.img 镜像上传到 examcontainer 容器中，并 设置分段存放，每一段大小为 10M。完成后提交控制节点的用户名、密码和 IP 地址到答题 框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">iaas-install-swift-controller.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># NODE compute</span>
</span></span><span class="line"><span class="cl">iaas-install-swift-compute.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">openstack container create examcontainer
</span></span><span class="line"><span class="cl">swift upload -S 10M examcontainer cirros-0.3.4-x86_64-disk.img 
</span></span></code></pre></div><h3 id="题目-12--cinder-创建硬盘05-分">【题目 12 】 Cinder 创建硬盘[0.5 分]</h3>
<p>​		在 控 制 节 点 和 计 算 节 点 分 别 使 用 iaas-install-cinder-controller.sh 、 iaas-install-cinder-compute.sh 脚本安装 Cinder 服务，请在计算节点，对块存储进行扩容操作， 即在计算节点再分出一个 5G 的分区，加入到 cinder 块存储的后端存储中去。完成后提交计 算节点的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">iaas-install-cinder-controller.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># NODE compute</span>
</span></span><span class="line"><span class="cl">iaas-install-cinder-compute.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pvcreate /dev/sdb4
</span></span><span class="line"><span class="cl">vgextend cinder-volumes /dev/sdb4
</span></span></code></pre></div><h3 id="题目-13--manila服务安装与使用05-分">【题目 13 】 Manila服务安装与使用[0.5 分]</h3>
<p>​		在 控 制 和 计 算 节 点 上 分 别 使 用 iaas-install-manila-controller.sh 和 iaas-install-manila-compute.sh 脚本安装 manila 服务。安装服务后创建 default_share_type 共享 类型（不使用驱动程序支持），接着创建一个大小为 2G 的共享存储名为 share01 并开放 share01 目录对 OpenStack 管理网段使用权限。最后提交控制节点的用户名、密码和 IP 地址 到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">iaas-install-manila-controller.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># NODE compute</span>
</span></span><span class="line"><span class="cl">iaas-install-manila-compute.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">manila type-create default_share_type <span class="nb">false</span>
</span></span><span class="line"><span class="cl">manila create NFS <span class="m">2</span> --name share01
</span></span><span class="line"><span class="cl">manila access-allow share01 ip 192.168.10.0/24 --access-level rw
</span></span></code></pre></div><h3 id="题目-14--barbican-服务安装与使用05-分">【题目 14 】 Barbican 服务安装与使用[0.5 分]</h3>
<p>​		使用 iaas-install-barbican.sh 脚本安装 barbican 服务，安装服务完毕后，使用 openstack 命令创建一个名为 secret01 的密钥，创建完成后提交控制节点的用户名、密码和 IP 地址到 答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">iaas-install-barbican.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">openstack secret store --name secret01 --payload <span class="nb">test</span>
</span></span></code></pre></div><h3 id="题目-15--cloudkitty-服务安装与使用1-分">【题目 15 】 Cloudkitty 服务安装与使用[1 分]</h3>
<p>​		使用 iaas-install-cloudkitty.sh 脚本安装 cloudkitty 服务，安装完毕后，启用 hashmap 评级 模块，接着创建 volume_thresholds 组，创建服务匹配规则 volume.size，并设置每 GB 的价 格为 0.01。接下来对应大量数据设置应用折扣，在组 volume_thresholds 中创建阈值，设置 若超过 50GB 的阈值，应用 2%的折扣（0.98）。设置完成后提交控制节点的用户名、密码 和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">iaas-install-cloudkitty.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">openstack rating modules <span class="nb">enable</span> hashmap
</span></span><span class="line"><span class="cl">openstack rating hashmap group create volume_thresholds
</span></span><span class="line"><span class="cl">openstack rating hashmap service create volume.size
</span></span><span class="line"><span class="cl">openstack rating hashmap mapping create -s servicelist -g grouplist -t flat  0.01
</span></span><span class="line"><span class="cl">openstack rating hashmap threshold create -s servicelist -g grouplist -t rate  <span class="m">50</span> 0.98
</span></span></code></pre></div><h3 id="题目-16--openstack平台内存优化05-分">【题目 16 】 Openstack平台内存优化[0.5 分]</h3>
<p>​		搭建完 OpenStack 平台后，关闭系统的内存共享，打开透明大页。完成后提交控制节点 的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;never&#39;</span> &gt;&gt; /sys/kernel/mm/transparent_hugepage/defrag
</span></span></code></pre></div><h3 id="题目-17--修改文件句柄数05-分">【题目 17 】 修改文件句柄数[0.5 分]</h3>
<p>​		Linux 服务器大并发时，往往需要预先调优 Linux 参数。默认情况下，Linux 最大文件 句柄数为 1024 个。当你的服务器在大并发达到极限时，就会报出“too many open files”。 创建一台云主机，修改相关配置，将控制节点的最大文件句柄数永久修改为 65535。配置完 成后提交 controller 点的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">cat &gt;&gt; /etc/security/limits.conf <span class="s">&lt;&lt;EOF
</span></span></span><span class="line"><span class="cl"><span class="s">* soft nofile 65535
</span></span></span><span class="line"><span class="cl"><span class="s">* hard nofile 65535
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span></code></pre></div><h3 id="题目-18-linux-系统调优-防止-syn-攻击1-分">【题目 18 】Linux 系统调优-防止 SYN 攻击[1 分]</h3>
<p>​		修改 controller 节点的相关配置文件，开启 SYN cookie，防止 SYN 洪水攻击。完成后 提交 controller 节点的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;net.ipv4.tcp_syncookies = 1&#34;</span> &gt;&gt; /etc/sysctl.conf
</span></span><span class="line"><span class="cl">sysctl -p
</span></span></code></pre></div><h2 id="任务-2私有云服务运维10-分">【任务 2】私有云服务运维[10 分]</h2>
<h3 id="题目-1openstack-开放镜像权限05-分">【题目 1】OpenStack 开放镜像权限[0.5 分]</h3>
<p>​		使 用 OpenStack 私 有 云 平 台 ， 在 OpenStack 平台的 admin 项 目 中 使 用 cirros-0.3.4-x86_64-disk.img 镜像文件创建名为 glance-cirros 的镜像，通过 OpenStack 命令将 glance-cirros 镜像指定 demo 项目进行共享使用。配置完成后提交 controller 点的用户名、密 码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl"><span class="c1">#demo admin</span>
</span></span><span class="line"><span class="cl">openstack image create glance-cirros --file cirros-0.3.4-x86_64-disk.img --disk-format qcow2 --container-format bare --shared
</span></span><span class="line"><span class="cl">openstack image add project glance-cirros demo
</span></span><span class="line"><span class="cl">glance  member-update image-id member-id accepted
</span></span></code></pre></div><h3 id="题目-2openstack-消息队列调优05-分">【题目 2】OpenStack 消息队列调优[0.5 分]</h3>
<p>​		OpenStack 各服务内部通信都是通过 RPC 来交互，各 agent 都需要去连接 RabbitMQ； 随着各服务 agent 增多，MQ 的连接数会随之增多，最终可能会到达上限，成为瓶颈。使用 自行搭建的OpenStack私有云平台，分别通过用户级别、系统级别、配置文件来设置RabbitMQ 服务的最大连接数为 10240，配置完成后提交修改节点的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 用户级别</span>
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF&gt;&gt;/etc/sysctl.conf
</span></span></span><span class="line"><span class="cl"><span class="s">fs.file-max = 10240
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 系统级别</span>
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF&gt;&gt;/etc/security/limits.conf
</span></span></span><span class="line"><span class="cl"><span class="s">openstack soft	nofile 10240
</span></span></span><span class="line"><span class="cl"><span class="s">openstack hard  nofile 10240
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 配置文件</span>
</span></span><span class="line"><span class="cl">vi /usr/lib/systemd/system/rabbitmq-server
</span></span><span class="line"><span class="cl"><span class="c1"># 在[Service]下添加</span>
</span></span><span class="line"><span class="cl"><span class="nv">LimitNOFILE</span><span class="o">=</span><span class="m">10240</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">systemctl restart rabbitmq-server
</span></span></code></pre></div><h3 id="题目-3openstack-glance-镜像压缩05-分">【题目 3】OpenStack Glance 镜像压缩[0.5 分]</h3>
<p>​		使用自行搭建的 OpenStack 平台。在 HTTP 服务中存在一个镜像为 CentOS7.5-compress.qcow2 的镜像，请使用 qemu 相关命令，对该镜像进行压缩，压缩后的 镜像命名为 chinaskill-js-compress.qcow2 并存放在/root 目录下。完成后提交 controller 点的用 户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">qemu-img convert -c -q -O qcow2 CentOS7.5-compress.qcow2 chinaskill-js-compress.qcow2
</span></span></code></pre></div><h3 id="题目-4glance-对接-cinder-后端存储05-分">【题目 4】glance 对接 cinder 后端存储[0.5 分]</h3>
<p>​		在自行搭建的 OpenStack平台中修改相关参数，使 glance 可以使用 cinder作为后端存储， 将镜像存储于 cinder 卷中。使用 cirros-0.3.4-x86_64-disk.img 文件创建 cirros-image 镜像存储 于 cirros-cinder 卷中，通过 cirros-image 镜像使用 cinder 卷启动盘的方式进行创建虚拟机。 完成后提交修改节点的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 修改glance-api.conf，在行3350</span>
</span></span><span class="line"><span class="cl"><span class="nv">stores</span><span class="o">=</span>file,http,cinder
</span></span><span class="line"><span class="cl"><span class="o">[</span><span class="nv">default_store</span><span class="o">=</span>cinder<span class="o">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 修改cinder.conf</span>
</span></span><span class="line"><span class="cl"><span class="nv">allowed_direct_url_schemes</span> <span class="o">=</span> cinder
</span></span><span class="line"><span class="cl"><span class="nv">image_upload_use_internal_tenant</span><span class="o">=</span>True
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">systemctl restart openstack-cinder* openstack-glance*
</span></span><span class="line"><span class="cl">openstack image create cirros-image --file cirros-0.3.4-x86_64-disk.img --disk-format qcow2 --container-format bare --public 
</span></span><span class="line"><span class="cl">openstack volume create cirros-cinder --image cirros-image --size <span class="m">1</span>
</span></span><span class="line"><span class="cl">openstack server create cirros --volume cirros-cinder --network eth0 --flavor <span class="m">2</span>
</span></span></code></pre></div><h3 id="题目-5openstack-heat-运维创建容器05-分">【题目 5】OpenStack Heat 运维：创建容器[0.5 分]</h3>
<p>​		在自行搭建的 OpenStack 私 有 云 平 台 上 ， 在 /root 目录下编写 Heat 模 板 create_container.yaml，要求执行 yaml 文件可以创建名为 heat-swift 的容器。完成后提交控制 节点的用户名、密码和 IP 地址到答题框。（在提交信息前请准备好 yaml 模板执行的环境）</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">iaas-install-heat.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF&gt;&gt; create_container.yaml
</span></span></span><span class="line"><span class="cl"><span class="s">heat_template_version: &#39;2016-10-14&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">description: Initial template of SwiftContainer
</span></span></span><span class="line"><span class="cl"><span class="s">resources:
</span></span></span><span class="line"><span class="cl"><span class="s">  SwiftContainer:
</span></span></span><span class="line"><span class="cl"><span class="s">    properties:
</span></span></span><span class="line"><span class="cl"><span class="s">      name: heat-swift
</span></span></span><span class="line"><span class="cl"><span class="s">    type: OS::Swift::Container
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">openstack stack create -f yaml -t create_container.yaml create_container
</span></span></code></pre></div><h3 id="题目-6openstack-nova-清除缓存05-分">【题目 6】OpenStack Nova 清除缓存[0.5 分]</h3>
<p>​		在 OpenStack 平台的一台计算节点创建虚拟机，若是第一次在该节点创建次虚拟机，会 先将镜像文件复制到该计算节点目录/var/lib/nova/instances/_base。长期下来，该目录会占用 比较大的磁盘空间而要清理。可以通过修改 nova 的配置文件来自动清理该缓存目录，即在 该节点没有使用某镜像启动的云主机，那么这个镜像在过一定的时间后会被自动删除。配置 完成后提交改动节点的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE controller</span>
</span></span><span class="line"><span class="cl">sed -i <span class="s1">&#39;145 aremove_unused_base_images=true&#39;</span> /etc/nova/nova.conf
</span></span><span class="line"><span class="cl">systemctl restart openstack-nova*
</span></span></code></pre></div><h3 id="题目-7redis-一主二从三哨兵模式1-分">【题目 7】Redis 一主二从三哨兵模式[1 分]</h3>
<p>​		使用提供的 OpenStack 私有云平台，申请三台 CentOS7.9 系统的云主机，使用提供的 http 源，在三个节点自行安装 Redis 服务并启动，配置 Redis 的访问需要密码，密码设置为 123456。然后将这三个 Redis 节点配置为 Redis 的一主二从三哨兵架构，即一个 Redis 主节 点，两个从节点，三个节点均为哨兵节点。配置完成后提交 Redis 主节点的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># *录有视频</span>
</span></span><span class="line"><span class="cl"><span class="c1">#tail -3 /etc/hosts</span>
</span></span><span class="line"><span class="cl">192.168.200.161 node1 <span class="c1">#主 哨兵 </span>
</span></span><span class="line"><span class="cl">192.168.200.162 node2 <span class="c1">#从 哨兵 </span>
</span></span><span class="line"><span class="cl">192.168.200.163 node3 <span class="c1">#从 哨兵</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ALL nodes</span>
</span></span><span class="line"><span class="cl">yum install redis -y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#node1</span>
</span></span><span class="line"><span class="cl">/etc/redis.conf
</span></span><span class="line"><span class="cl"><span class="nb">bind</span> 0.0.0.0
</span></span><span class="line"><span class="cl">requirepass <span class="m">123456</span>
</span></span><span class="line"><span class="cl">protected-mode no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#node2,node3</span>
</span></span><span class="line"><span class="cl">/etc/redis.conf
</span></span><span class="line"><span class="cl"><span class="nb">bind</span> 0.0.0.0
</span></span><span class="line"><span class="cl">slaveof node1 <span class="m">6379</span>
</span></span><span class="line"><span class="cl">masterauth <span class="m">123456</span>
</span></span><span class="line"><span class="cl">protected-mode no
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ALL nodes</span>
</span></span><span class="line"><span class="cl">/etc/redis-sentinel.conf
</span></span><span class="line"><span class="cl"><span class="nb">bind</span> 0.0.0.0
</span></span><span class="line"><span class="cl">sentinel monitor mymaster node1 <span class="m">6379</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl">sentinel auth-pass mymaster <span class="m">123456</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">systemctl <span class="nb">enable</span> --now redis*
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#查看</span>
</span></span><span class="line"><span class="cl">redis-cli 
</span></span><span class="line"><span class="cl">info replication
</span></span></code></pre></div><h3 id="题目-8redis-服务调优-aof1-分">【题目 8】Redis 服务调优-AOF[1 分]</h3>
<p>​		使用上一题安装的 Redis 服务。在 Redis 中，AOF 配置为以三种不同的方式在磁盘上执 行 write 或者 fsync。假设当前 Redis 压力过大，请配置 Redis 不执行 fsync。除此之外，避免 AOF 文件过大，Redis 会进行 AOF 重写，生成缩小的 AOF 文件。请修改配置，让 AOF 重 写时，不进行 fsync 操作。配置完成后提交 Redis 节点的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE redis</span>
</span></span><span class="line"><span class="cl">sed -i <span class="s1">&#39;s/appendfsync everysec/appendfsync no/g&#39;</span> /etc/redis.conf
</span></span><span class="line"><span class="cl">sed -i <span class="s1">&#39;s/no-appendfsync-on-rewrite yes/no-appendfsync-on-rewrite no/g&#39;</span> /etc/redis.conf
</span></span><span class="line"><span class="cl"><span class="o">[</span>systemctl restart redis<span class="o">]</span>
</span></span></code></pre></div><h3 id="题目-9应用部署堡垒机部署05-分">【题目 9】应用部署：堡垒机部署[0.5 分]</h3>
<p>​		使用提供的 OpenStack 平台申请一台 CentOS7.9 的云主机，使用提供的软件包安装 JumpServer 堡垒机服务，并配置使用该堡垒机对接自己安装的 controller 和 compute 节点。 完成后提交 JumpServer 节点的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># *录有视频
</span></span></span><span class="line"><span class="cl"><span class="gh"># 文档
</span></span></span></code></pre></div><h3 id="题目-10skywalking-服务部署与应用1-分">【题目 10】skywalking 服务部署与应用[1 分]</h3>
<p>​		使用提供的 OpenStack 私有云平台，申请一台 centos7.9 系统的云主机，使用提供的软 件包安装 Elasticsearch 服务和 skywalking 服务，将 skywalking 的 UI 访问端口修改为 8888。 接下来再申请一台CentOS7.9的云主机，用于搭建gpmall商城应用，并配置SkyWalking Agent， 将 gpmall 的 jar 包放置探针并启动。安装与配置完成后提交 skywalking 节点的用户名、密码 和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># *录有视频
</span></span></span><span class="line"><span class="cl"><span class="gh"># 文档另附
</span></span></span></code></pre></div><h3 id="题目-11linux-内核优化1-分">【题目 11】Linux 内核优化[1 分]</h3>
<p>​		在使用 Linux 服务器的时候，TCP 协议规定，对于已经建立的连接，网络双方要进行四 次挥手才能成功断开连接，如果缺少了其中某个步骤，将会使连接处于假死状态，连接本身 占用的资源不会被释放。因为服务器程序要同时管理大量连接，所以很有必要保证无用的连 接完全断开，否则大量僵死的连接会浪费许多服务器资源。创建一台 CentOS7.9 云主机，修 改相应的配置文件，分别开启 SYN Cookies；允许将 TIME-WAIT sockets 重新用于新的 TCP 连接；开启 TCP 连接中 TIME-WAIT sockets 的快速回收；修改系統默认的 TIMEOUT 时间 为 30。完成后提交修改节点的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># NODE node1</span>
</span></span><span class="line"><span class="cl">cat <span class="s">&lt;&lt;EOF&gt;&gt;/etc/sysctl.conf
</span></span></span><span class="line"><span class="cl"><span class="s">net.ipv4.tcp_syncookies = 1
</span></span></span><span class="line"><span class="cl"><span class="s">net.ipv4.tcp_tw_reuse = 1
</span></span></span><span class="line"><span class="cl"><span class="s">net.ipv4.tcp_tw_recycle = 1
</span></span></span><span class="line"><span class="cl"><span class="s">net.ipv4.tcp_fin_timeout = 30
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">sysctl -p
</span></span></code></pre></div><h3 id="题目-12排错glance-服务排错1-分">【题目 12】排错：Glance 服务排错[1 分]</h3>
<p>​		使用赛项提供的 chinaskill-error1 镜像启动云主机，flavor 使用 4vcpu/12G 内存/100G 硬 盘。启动后存在错误的私有云平台，错误现象为查看不到 image 列表，试根据错误信息排查 云平台错误，使云平台可以查询到 image 信息。完成后提交云主机节点的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># 镜像缺失
</span></span></span><span class="line"><span class="cl"><span class="gh"># *glance分析讲解
</span></span></span></code></pre></div><h3 id="题目-13排错数据库排错15-分">【题目 13】排错：数据库排错[1.5 分]</h3>
<p>​		使用赛项提供的排错镜像 chinaskill-error2 创建一台云主机（云主机的登录用户名为 root， 密码为 000000），该云主机中存在错误的数据库服务，错误现象为数据库服务无法启动。 请将数据库服务修复并启动，将数据库的密码修改为 chinaskill123。修复完成后提交该云主 机的用户名、密码和 IP 地址到答题框。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#controller node</span>
</span></span><span class="line"><span class="cl">/etc/my.cnf
</span></span><span class="line"><span class="cl"> <span class="o">[</span>mysqld<span class="o">]</span>
</span></span><span class="line"><span class="cl">skip-grant-tables
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">systemctl restart mariadb
</span></span><span class="line"><span class="cl">mysql -uroot
</span></span><span class="line"><span class="cl">use mysql<span class="p">;</span>
</span></span><span class="line"><span class="cl">update user <span class="nb">set</span> <span class="nv">password</span><span class="o">=</span>password <span class="o">(</span><span class="s1">&#39;chinaskill&#39;</span><span class="o">)</span> where <span class="nv">user</span> <span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">flush privileges<span class="p">;</span>
</span></span></code></pre></div><h2 id="任务-3私有云运维开发10-分">【任务 3】私有云运维开发[10 分]</h2>
<h3 id="题目-1ansible-服务部署部署-mariadb-集群2-分">【题目 1】Ansible 服务部署：部署 MariaDB 集群[2 分]</h3>
<p>​		使用 OpenStack 私有云平台，创建 4 台系统为 centos7.9 的云主机，其中一台作为 Ansible 的母机并命名为 ansible，另外三台云主机命名为 node1、node2、node3；使用这一台母机， 编写 Ansible 脚本（在/root 目录下创建 example 目录作为 Ansible 工作目录，部署的入口文 件 命 名 为 cscc_install.yaml ） ， 对 其 他 三 台 云 主 机 进 行 安 装 高 可 用 数 据 库 集 群 （MariaDB_Galera_cluster，数据库密码设置为 123456）的操作（所需的安装包在 HTTP 服 务中）。完成后提交 Ansible 节点的用户名、密码和 IP 地址到答题框。（考试系统会连接到 你的 Ansible 节点，去执行 Ansible 脚本，请准备好 Ansible 运行环境，以便考试系统访问）</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># *录有视频
</span></span></span><span class="line"><span class="cl"><span class="gh"># *文档另附
</span></span></span></code></pre></div><h3 id="题目-2ansible-服务部署部署-elk-集群服务2-分">【题目 2】Ansible 服务部署：部署 ELK 集群服务[2 分]</h3>
<p>​		使用赛项提供的 OpenStack 私有云平台，创建三台 CentOS7.9 系统的云主机分别命名为 elk-1、elk-2 和 elk-3，Ansible 主机可以使用上一题的环境。要求 Ansible 节点编写剧本，执 行 Ansible 剧本可以在这三个节点部署 ELK 集群服务（在/root 目录下创建 install_elk 目录作 为 ansible 工作目录，部署的入口文件命名为 install_elk.yaml）。具体要求为三个节点均安装 Elasticserach 服务并配置为 Elasticserach 集群；kibana 安装在第一个节点；Logstash 安装在 第二个节点。（需要用到的软件包在 HTTP 服务下）完成后提交 ansible 节点的用户名、密 码和 IP 地址到答题框。（考试系统会连接到 ansible 节点，执行 ansible 脚本，准备好环境， 以便考试系统访问）</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># *录有视频
</span></span></span><span class="line"><span class="cl"><span class="gh"># *文档另附
</span></span></span></code></pre></div><h3 id="题目-3python-运维开发基于-openstack-restful-api-实现镜像上传1-分">【题目 3】Python 运维开发：基于 OpenStack Restful API 实现镜像上传[1 分]</h3>
<p>​		使用 OpenStack all-in-one 镜像，创建 OpenStack Python 运维开发环境。云主机的用户/ 密码为：“root/Abc@1234”，OpenStack 的域名/账号/密码为：“demo/admin/000000”。</p>
<p>​		提示说明：python 脚本文件头建议加入“#encoding:utf-8”避免编码错误；测试脚本代 码用 python3 命令执行与测试。</p>
<p>​		在 controller 节点的/root 目录下创建 api_image_manager.py 脚本，编写 python 代码对接 OpenStack API，完成镜像的创建与上传。创建之前查询是否存在“同名镜像”，如果存在 先删除该镜像。</p>
<p>​		（1）创建镜像：要求在 OpenStack 私有云平台中上传镜像 cirros-0.3.4-x86_64-disk.img， 名字为 cirros001，disk_format 为 qcow2，container_format 为 bare。</p>
<p>​		（2）查询镜像：查询 cirros001 的详细信息，并以 json 格式文本输出到控制台。</p>
<p>​		完成后提交 OpenStack Python 运维开发环境 Controller 节点的 IP 地址，用户名和密码提 交。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># *录有视频
</span></span></span><span class="line"><span class="cl"><span class="gh"># *文档另附
</span></span></span></code></pre></div><h3 id="题目-4python-运维开发基于-openstack-python-sdk-实现云主机创建1-分">【题目 4】Python 运维开发：基于 Openstack Python SDK 实现云主机创建[1 分]</h3>
<p>​		使 用 已 建 好 的 OpenStack Python 运 维 开 发 环 境 ， 在 /root 目 录 下 创 建 sdk_server_manager.py 脚本，使用 python-openstacksdk Python 模块，完成云主机的创建和查 询。创建之前查询是否存在“同名云主机”，如果存在先删除该镜像。</p>
<p>​		（1）创建 1 台云主机：云主机信息如下：</p>
<p>​		云主机名称如下：server001</p>
<p>​		镜像文件：cirros-0.3.4-x86_64-disk.img</p>
<p>​		云主机类型：m1.tiny</p>
<p>​		网络等必要信息自己补充。</p>
<p>​		（2）查询云主机：查询云主机 server001 的详细信息，并以 json 格式文本输出到控制 台。</p>
<p>​		完成后提交 OpenStack Python 运维开发环境 Controller 节点的 IP 地址，用户名和密码 提交。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># *录有视频
</span></span></span><span class="line"><span class="cl"><span class="gh"># *文档另附
</span></span></span></code></pre></div><h3 id="题目-5python-运维开发云主机类型管理的命令行工具开发2-分">【题目 5】Python 运维开发：云主机类型管理的命令行工具开发[2 分]</h3>
<p>​		使用已建好的 OpenStack Python 运维开发环境，在/root 目录下创建 flavor_manager.py 脚本，完成云主机类型的管理，flavor_manager.py 程序支持命令行参数执行。</p>
<p>​		提示说明：Python 标准库 argparse 模块，可以提供命令行参数的解析。</p>
<p>​		要求如下：</p>
<p>​		（1）程序支持根据命令行参数，创建 1 个多云主机类型。返回 response。</p>
<p>​		位置参数“create”，表示创建；</p>
<p>​		参数“-n”支持指定 flavor 名称，数据类型为字符串类型；</p>
<p>​		参数“-m”支持指定内存大小，数据类型为 int，单位 M；</p>
<p>​		参数“-v”支持指定虚拟 cpu 个数，数据类型为 int；</p>
<p>​		参数“-d”支持磁盘大小，内存大小类型为 int，单位 G；</p>
<p>​		参数“-id”支持指定 ID，类型为字符串。</p>
<p>​		参考运行实例：</p>
<p>​		python3 flavor_manager.py create -n flavor_small -m 1024 -v 1 -d 10 -id 100000</p>
<p>​		（2）程序支持查询目前 admin 账号下所有的云主机类型。</p>
<p>​		位置参数“getall”，表示查询所有云主机类型；</p>
<p>​		查询结果，以 json 格式输出到控制台。</p>
<p>​		参考执行实例如下：</p>
<p>​		python3 flavor_manager.py getall</p>
<p>​		（3）支持查询给定具体名称的云主机类型查询。</p>
<p>​		位置参数“get”，表示查询 1 个云主机类型；</p>
<p>​		参数“-id”支持指定 ID 查询，类型为 string。</p>
<p>​		控制台以 json 格式输出创建结果。</p>
<p>​		参考执行实例如下：</p>
<p>​		python3 flavor_manager.py get -id 100000</p>
<p>​		（4）支持删除指定的 ID 云主机类型。</p>
<p>​		位置参数“delete”，表示删除一个云主机类型；</p>
<p>​		参数“-id”支持指定 ID 查询，返回 response，控制台输出 response。</p>
<p>​		参考执行实例如下：</p>
<p>​		python3 flavor_manager.py delete -id 100001</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># *录有视频
</span></span></span><span class="line"><span class="cl"><span class="gh"># *文档另附
</span></span></span></code></pre></div><h3 id="题目-6python-运维开发用户管理的命令行工具开发2-分">【题目 6】Python 运维开发：用户管理的命令行工具开发[2 分]</h3>
<p>​		使用已建好的 OpenStack Python 运维开发环境，在/root 目录下创建 user_manager.py 脚 本，完成用户管理功能开发，user_manager.py 程序支持命令行带参数执行。</p>
<p>​		提示说明：Python 标准库 argparse 模块，可以提供命令行参数的解析。</p>
<p>​		（1）程序支持根据命令行参数，创建 1 个用户。</p>
<p>​		位置参数“create”，表示创建；</p>
<p>​		参数“-i 或&ndash;input”，格式为 json 格式文本用户数据。</p>
<p>​		查询结果，以 json 格式输出到控制台。</p>
<p>​		参考执行实例如下：</p>
<p>​		python3 user_manager.py create &ndash;input &lsquo;{ &ldquo;name&rdquo;: &ldquo;user01&rdquo;, &ldquo;password&rdquo;: &ldquo;000000&rdquo;,  &ldquo;description&rdquo;: &ldquo;description&rdquo; } '</p>
<p>​		（2）支持查询给定具体名称的用户查询。</p>
<p>​		位置参数“get”，表示查询 1 个用户；</p>
<p>​		参数“-n 或 &ndash;name”支持指定名称查询，类型为 string。</p>
<p>​		参数“-o 或 output”支持查询该用户信息输出到文件，格式为 json 格式。</p>
<p>​		参考执行实例如下：</p>
<p>​		python3 user_manager.py get &ndash;name user01-o user.json</p>
<p>​		（3）程序支持查询目前 admin 账号下所有的用户。</p>
<p>​		位置参数“getall”，表示查询所有用户；</p>
<p>​		参数“-o 或&ndash;output”支持输出到文件，格式为 yaml 格式。</p>
<p>​		参考执行实例如下：</p>
<p>​		python3 user_manager.py getall -o openstack_all_user.yaml</p>
<p>​		（4）支持删除指定的名称的用户。</p>
<p>​		位置参数“delete”，表示删除一个用户；返回 response，通过控制台输出。</p>
<p>​		参数“-n 或&ndash;name”支持指定名称查询，类型为 string。</p>
<p>​		参考执行实例如下：</p>
<p>​		python3 user_manager.py delete -name user01</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gh"># *录有视频
</span></span></span><span class="line"><span class="cl"><span class="gh"># *文档另附
</span></span></span></code></pre></div></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title=2022-02-02&#32;13:40:04>更新于 2023-02-02&nbsp;</span>
      </div><div class="post-info-license">
          <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span>
        </div></div>
    <div class="post-info-line">
      <div class="post-info-md"></div>
      <div class="post-info-share">
        <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="http://feyncode.github.io/posts/2022%E5%B9%B4%E5%9B%BD%E8%B5%9B%E4%BA%91%E8%AE%A1%E7%AE%97%E7%A7%81%E6%9C%89%E4%BA%91/" data-title="2022年国赛云计算私有云" data-hashtags="draft"><i class="fa-brands fa-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="http://feyncode.github.io/posts/2022%E5%B9%B4%E5%9B%BD%E8%B5%9B%E4%BA%91%E8%AE%A1%E7%AE%97%E7%A7%81%E6%9C%89%E4%BA%91/" data-hashtag="draft"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="http://feyncode.github.io/posts/2022%E5%B9%B4%E5%9B%BD%E8%B5%9B%E4%BA%91%E8%AE%A1%E7%AE%97%E7%A7%81%E6%9C%89%E4%BA%91/" data-title="2022年国赛云计算私有云"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
      </div>
    </div>
  </div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/draft/">draft</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/python%E8%BF%90%E7%BB%B4%E5%BC%80%E5%8F%91%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/" class="prev" rel="prev" title="Python运维开发用户管理"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>Python运维开发用户管理</a></div>
</div>
<div id="comments"><div id="utterances" class="comment"></div><noscript>
        Please enable JavaScript to view the comments powered by <a href="https://utteranc.es/" rel="external nofollow noopener noreferrer">Utterances</a>.
      </noscript></div></article></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.108.0">Hugo</a> 强力驱动 
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2022 - 2023</span><span class="author" itemprop="copyrightHolder">
              <a href="/">feyncode</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div><div class="footer-line statistics"></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div><div class="fixed-button view-comments d-none" role="button" aria-label="查看评论"><i class="fa-solid fa-comment fa-fw" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">FixIt 主题在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/lunr/lunr.min.js" defer></script><script src="/lib/lunr/lunr.stemmer.support.min.js" defer></script><script src="/lib/lunr/lunr.zh.min.js" defer></script><script src="/lib/lazysizes/lazysizes.min.js" async defer></script><script src="/lib/twemoji/twemoji.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":10},"comment":{"enable":true,"utterances":{"darkTheme":"github-dark","issueTerm":"pathname","label":"","lightTheme":"github-light","repo":"feyncode/hugotalks"}},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验。"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"search":{"highlightTag":"em","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":30},"twemoji":true};</script><script src="/js/theme.min.js" defer></script></body>
</html>
